# 4. Designing the Web Architecture: Problems and Insights

## Summary

웹이 실제로 어떤 요구사항을 가지고 있는지, 웹 설계의 문제 인식과 방법론에 대해서 언급하는 장입니다.

즉, 초기 웹에 대해서 알아보고 그러한 문제점을 인식한 상태로 REST 설계 원칙의 토대를 설명합니다.


## 4.1 WWW Application Domain Requirements

World Wide Web은 대규모 하이퍼미디어 배포 시스템입니다.

쉽게 말해, 정보 공유를 위한 전 세계적 인프라로, 다양한 종류의 데이터를 다양한 형태로 배포하는 시스템입니다.

웹은 확장성(규모의 확장), 단순성(누구나 쉽게 참여/구현), 확장 가능성(새로운 서비스와 타입의 추가), 상호운용성(호환성)

이라는 목표를 달성하기 위해서 제약을 설계에 반영하게 되었습니다.

웹이 필요한 이유는 정보 지속성에 관계없이 자기를 포함한 다른 모두가 정보를 사용할 수 있도록 하는 방법이 필요했기 때문에 만들어진 것이었습니다.

초기에 WWW는 유럽물리입자연구소에서 지식 문서를 공유하기 위한 내부 프로젝트였습니다.

제각각인 컴퓨터 환경과 서로 다른 형태의 문서를 통합적으로 모두가 공유하기 위해서 웹은 다음과 같은 시스템을 요구할 수 밖에 없었습니다.

  다양한 플랫폼에서, 누구나 참여하여, 점진적으로 진화가능하며 구조화된 정보를 일관적으로 접근하는 시스템

이것이 웹이라는 시스템에게 주어진 근본적인 요구사항이었습니다.

  1. 낮은 진입장벽: 웹은 자발적이고 쉬운 참여를 장려하기 때문에, 사용자는 입력을 기반으로 검색을 하고 결과를 하이퍼미디어로 받을 수 있도록 설계되었으며,
  
  작성자는 HTML이라는 단순한 언어로 읽고 쓸 수 있고 Reference(참조, 링크라고 이해하면 좋을 것 같습니다.)는 문서가 없어도 생성가능하도록 하였습니다.

  개발자는 텍스트 기반 프로토콜을 통해 직접 통신을 테스트합니다.

  2. 확장성: 사용자의 요구는 시간에 따라 바뀌는데, 장기적으로 웹을 진화할 수 있는 구조로 설계해야 함을 뜻했습니다.

  3. 분산 하이퍼미디어: 하이퍼미디어는 정보(텍스트 등)에 애플리케이션 제어 정보(링크, 폼 등)를 포함하거나 표시 계층 위에 존재하는 도구를 말합니다.
  
  분산 하이퍼미디어는 정보와 제어 요소가 서로 다른 장소에 분산 저장된 것을 말합니다. 그러니까, 링크를 클릭하면 다른 데이터가 나와야하는 대용량 데이터 전송 중심으로 설계가 되어야함을 의미합니다.

  그러나, 이렇게 되면 지연시간(Latency)가 길어져 사용자 경험이 나빠져 왕복을 줄이는데 초점을 맞춰야 했다고 저자는 주장합니다.

  4. 인터넷 규모 확장성: 웹은 전 세계적인 규모의 분산 시스템으로 여러 조직이나 네트워크 경계를 넘는 환경을 다뤄야 했습니다.

  즉, 무질서한 확장(누구나 참여하면서도 협조하지 않아도 된다)라는 원칙 아래, 어떠한 부하나 악의적 데이터를 견뎌야 했습니다.

  여기서 필딩은 **모든 서버가 클라이언트를 기억할 수 없고**, **클라이언트는 모든 서버를 알 수 없고**, **리소스가 자신을 가리키는 모든 링크를 저장할 수 없다**라는 한계를 지적합니다.

  보안도 마찬가지로, **다중 신뢰 경계**, **정책에 어긋난 요청 차단**, **모든 데이터는 신뢰할 수 없음을 기본 전제로**라는 가정 하에 확장성이 떨어지는 인증 대신
  
  GET, HEAD같은 서버에 직접적인 영향이 적은 비신뢰 연산을 기본 동작으로 해야한다고 말합니다.

  또한 웹은 분산 시스템이기 때문에, 독립적으로 발전해야 하므로 새로운 기능과 오래된 기능이 공존해야하며 점진적 배포가 가능해야 하기에 새로운 헤더를 추가하여 버전 식별과 호환성 관리가 가능해야 합니다.
  

## 4.2 Problem

이 절에서는 웹이 직면한 문제들에 대해서 다룹니다.

웹이 성장하게 되면서, 웹에는 단순 텍스트뿐만 아니라 다양한 미디어를 포함한 복합 문서로 사용되기 시작했습니다.

즉, 한 페이지를 위해 수십 개의 요청이 동시에 발생하게 되고 이건 기존의 프로토콜과 구조로 감당할 수 없었습니다.

확장성 부족, 공유 캐싱 자원 부족, 중간 계층 미지원, 표준 불일치와 같은 한계에 부딪히게 되었습니다.

그러기 위해서, 웹의 기존 구조들에서 공통 부분을 정의하고, 거기서 문제점을 발견하여, 새로운 표준을 만든다 라는 과정이 필요했습니다.

그러나 또 다른 문제가 있었는데, 과연 기존의 시스템 위에서 도입가능하면서도 웹의 핵심 설계 원칙을 훼손하지 않아야 한다는 도전과제를 안게 되었고,

이것이 REST가 나오게 된 출발점이었습니다.

쉽게 말해, 확장성과 일관성을 바로 잡기 위해 등장한 것이 REST 아키텍처 스타일이었습니다.

## 4.3 Approach

초창기 웹에는 공식적인 설계 방식이나 아키텍처가 존재하지 않았습니다.

모든 건 구현만 되어있어고 작동 방식은 알 수 없었습니다.

필딩은 여기서 다시 한번, 아키텍처 스타일은 **제약의 집합**임을 강조합니다.

계속 필딩이 강조하듯이, 어떤 제약을 조합하느냐에 따라 시스템 품질이 달라집니다.

제약을 모아놓으면 **디자인 철학**이 보이게 됩니다.

필딩은

  1. 초기 웹 구현에서의 제약을 찾고
  2. 부족한 품질 속성을 메꾸기 위해 다른 제약을 추가하여
  3. 새로운 웹 확장 제안이 이 스타일과 충돌하는지 평가

즉, REST는 **초기 웹 제약 + 추가된 제약들로 이루어진 하이브리드 스타일**로 볼 수 있습니다.

여기서 필딩은 세 가지 가설을 제시합니다.

  1. 웹의 설계 원칙을 아키텍처 스타일(제약 집합)으로 설명할 수 있다.
  2. 기존 스타일에 제약을 추가하면 REST로 발전시킬 수 있다.
  3. 새로운 웹 확장과 기존 스타일을 비교해 충돌 여부를 미리 평가할 수 있다.
REST를 단순 HTTP API를 사용하는 것이 아니라, 설계 방법론이라는 것입니다.

필딩은 이러한 방식을 실험을 통해 검증하였으며, 연구 환경이 아니라 실제 코드 테스트를 통해 탄생한 설계 모델이라는 것을 강조합니다.
